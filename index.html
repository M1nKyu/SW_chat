<!DOCTYPE html>
<html>
<head>
    <title>Chat App</title>
</head>
<style>
    body{
        background-color : #F8A092;
        text-align: center;
    }
    button{
        position: absolute;
        background-color: #0a0a23;
        color: #fff;
        border:none;
        border-radius:10px;
    }
    button:hover{
        background-color : #002ead;
        transition: 0.7s;
    }
</style>
<body>
    <table id="chatTable" border="1" style="background-color: yellow;"> 
    </table>
    <input type="text" id="messageInput" placeholder="메시지를 입력하세요..."> 
    <button onclick="sendMessage()">전송</button> 

    <script>
        const ws = new WebSocket('ws://localhost:8080');
        const chatTable = document.getElementById('chatTable'); 
        const messageInput = document.getElementById('messageInput'); 

        ws.onmessage = function(event) {
            if (event.data instanceof Blob) {
                const reader = new FileReader();
                reader.onload = function() {
                    const message = document.createElement('p');
                    message.textContent = reader.result;
                    appendMessageToTable(message);
                };
                reader.readAsText(event.data);
            } else {
                const message = document.createElement('p');
                message.textContent = event.data;
                appendMessageToTable(message);
            }
        };

        function sendMessage() {
            var today = new Date();   
            var hours = ('0' + today.getHours()).slice(-2); 
            var minutes = ('0' + today.getMinutes()).slice(-2);
            var seconds = ('0' + today.getSeconds()).slice(-2); 
            var timeString = hours + ':' + minutes  + ':' + seconds+' ';

            const message = timeString + messageInput.value;
            ws.send(message);
            messageInput.value = ''; 
        }

        function appendMessageToTable(messageElement) {
            const row = chatTable.insertRow(-1); 
            const cell = row.insertCell(0); 
            cell.appendChild(messageElement);
        }
    </script>
</body>
</html>
